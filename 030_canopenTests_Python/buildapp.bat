@ECHO OFF
ECHO Building app.py with pyinstaller
ECHO ============================

RMDIR .\build\ /s /q
MKDIR build

CD canopen
pyinstaller --onefile --clean app.py

IF %ERRORLEVEL% NEQ 0 ( 
   ECHO pyinstaller failed with Error Code %ERRORLEVEL%
   EXIT
)

COPY .\dist\app.exe ..\build\
XCOPY .\dll ..\build\dll /e /i
XCOPY .\eds ..\build\eds /e /i
XCOPY .\src ..\build\src /e /i
COPY .\PCANBasic.dll ..\build\

RMDIR .\__pycache__\ /s /q
RMDIR .\build\ /s /q
RMDIR .\dist\ /s /q
DEL .\app.spec

ECHO ============================
ECHO Building Done ! ...
EXIT