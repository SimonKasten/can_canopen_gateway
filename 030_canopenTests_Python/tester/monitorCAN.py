#!/usr/bin/env python
import can
import sys, getopt

def receive_all(argv):

    channelnr = 0
    try:
        opts, args = getopt.getopt(argv,"hc:",["channel="])
    except getopt.GetoptError:
        print("USAGE:  monitorCAN.py -c <channel>")
        sys.exit(2)
    for opt, arg in opts:
        if opt == '-h':
            print("USAGE:  monitorCAN.py -c <channel>")
            sys.exit()
        elif opt in ("-c", "--channel"):
            channelnr = arg

    print('Using vector CANCaseXL with Channel: ', channelnr)



    bus = can.interface.Bus(bustype='vector', app_name='CANape', channel=channelnr, bitrate=500000)

    try:
        while True:
            msg = bus.recv(1)
            if msg is not None:
                print(msg)
                #if (msg.arbitration_id & 0xFF) < 0x80 : 

    except KeyboardInterrupt:
        pass  # exit normally

if __name__ == "__main__":
    receive_all(sys.argv[1:])