@ECHO OFF
ECHO Building main.py with pyinstaller
ECHO ============================

RMDIR .\gateway_exe\ /s /q
MKDIR gateway_exe

CD translator
pyinstaller --onefile --clean main.py

IF %ERRORLEVEL% NEQ 0 ( 
   ECHO pyinstaller failed with Error Code %ERRORLEVEL%
   EXIT
)

COPY .\dist\main.exe ..\gateway_exe\
XCOPY .\dll ..\gateway_exe\dll /e /i
XCOPY .\dbcs ..\gateway_exe\dbcs /e /i
XCOPY .\EDS ..\gateway_exe\EDS /e /i
COPY .\PCANBasic.dll ..\build\

RMDIR .\__pycache__\ /s /q
RMDIR .\build\ /s /q
RMDIR .\dist\ /s /q
DEL .\main.spec

ECHO ============================
ECHO Building Done ! ...
EXIT